# SafeOn: An Anomaly Detection System for Smart Home IoT Security
> 한양대학교 2025-2 소프트웨어공학/인공지능및응용 프로젝트 (SWE/AI Project in Hanayang Univ. 2025-2)

## Group Members
| Name | Organization | Email |
|------|-------------|--------|
| Juseong Jeon | Department of Information Systems, Hanyang University | hyu22ix@hanyang.ac.kr |
| Jaemin Jung | Department of Information Systems, Hanyang University | woals5633@hanyang.ac.kr |
| Wonyoung Shin | Department of Information Systems, Hanyang University | pingu090@hanyang.ac.kr |
| Seungmin Son | Department of Information Systems, Hanyang University | andyson0205@gmail.com |


## I. Introduction
The modern smart home environment is rapidly evolving into a hyper-connected network where diverse IoT devices—robot vacuums, smart TVs, refrigerators, cameras, air purifiers, and more—operate simultaneously. While this brings convenience, it also introduces significant security risks. Due to the low hardware capabilities of IoT devices and limited OS/firmware updates, traditional PC or server-centric security mechanisms cannot be directly applied. Attackers can compromise a single weak device and easily expand to the entire home network.
SafeOn is an edge-first EDR (Endpoint Detection & Response) framework optimized for smart home environments. It leverages the home gateway (OpenWrt-based router or Raspberry Pi) as a security hub, performing real-time packet/flow inspection, ML-based anomaly detection, and Digital Twin–based behavioral simulation.

SafeOn integrates the following multi-stage detection pipeline:

- Isolation Forest for snapshot-level flow anomaly detection
- LSTM Autoencoder for long-term behavioral modeling
- Transformer Autoencoder for capturing high-dimensional flow dependencies and context-aware anomaly patterns
- Digital Twin prediction → residual-based anomaly scoring

These mechanisms enable SafeOn to detect abnormal device behaviors in real time and notify users immediately.
Project goals include:

- Local, privacy-preserving real-time anomaly detection without sending personal data to the cloud
- Edge-optimized inference using lightweight ML models
- Digital Twin–based behavioral prediction for improved residual-based anomaly scoring
- User-friendly EDR dashboard and forensic log generation

SafeOn aims to provide a practical and scalable security solution for increasingly sophisticated IoT-targeted cyberattacks.

## II. Datasets

SafeOn’s anomaly detection model is trained entirely on custom, real-world data, without relying on public datasets.
Approximately 1,000 flow-level samples were captured from an ESP32-CAM smart home camera under real streaming conditions.
Because the dataset reflects authentic smart-camera behavior, the ML models learn realistic traffic patterns representative of lightweight IoT devices.

### 1. Data Collection Setup

Traffic was experimentally collected under the following environment:

- ESP32-CAM (real-time video streaming)
- OpenWrt-based gateway
- tcpdump-based packet capture
- Repeated normal/abnormal scenarios within a controlled LAN environment

Although lightweight, the ESP32-CAM generates diverse traffic—including video streaming, HTTP API requests, and internal keep-alive packets—making it a good representation of low-power smart-camera behavior in home networks.

### 2. Dataset Composition

The dataset contains approximately 1,000 flow-level samples, consisting of three primary traffic categories.

#### (2-1) Video Streaming

Flows generated during continuous video streaming from the ESP32-CAM.
Characteristics:

- Consistent high-byte flows
- Periodic packet emission
- Persistent outbound connection to the viewing server

These flows form the baseline normal behavior of the device.

#### (2-2) HTTP / API Control Flows

Flows generated by internal device control—configuration checks, frame requests, status queries, etc.
Characteristics:

- Small request-response flows
- Stable byte counts

These flows occur during normal control events, but attackers may generate similar patterns when attempting unauthorized access, making them crucial features for anomaly detection.

#### (2-3) Miscellaneous Bidirectional Traffic

The device also generates various low-level background communications:

- Keep-alive packets
- Internal service port access
- Metadata exchange
- Temporary cache/buffer flush packets

Characteristics:

- Low frequency
- Small packet size
- Intermittent bidirectional flows

These flows form the background noise of normal device behavior.

### 3. Feature Extraction (Flow-Based Processing)

Since no behavioral or sensor telemetry exists, SafeOn constructs all features strictly through
Packet → Flow → Feature processing.

Each flow is normalized using the following feature set:

| Feature |	Description |
|---------|-------------|
| byte_count |	Total bytes transferred |
| packet_count |	Number of packets |
|flow_duration	| Duration of the flow |
| src_port / dst_port	| Traffic origin/destination |
| protocol	| TCP / UDP |
| pps	| Packets per second |
| bps	| Bytes per second |
| time_bucket |	Discretized time segment indicating when the flow occurred  |
| label |	Normal / Attack |

These features are used for:

- Isolation Forest → single-flow anomaly detection
- LSTM (optional) → short-term temporal pattern analysis

### 4. Dataset Statistics
| Item |	Value |
|------|--------|
| Total flow samples |	~1,000 |
| Normal streaming/control flows |	~90% |
| Abnormal/intentional anomaly flows |	~10% |

Although relatively small, the dataset provides a clear, well-defined normal behavior profile for a single IoT device, making it highly suitable for flow-level anomaly detection using the Isolation Forest method.
